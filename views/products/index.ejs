<%- include('../partials/header') %>
<div class="container products-page">
  <h2>Danh sách sản phẩm</h2>
  <form method="GET" action="/products" class="search-form">
    <input type="text" name="search" value="<%= search %>" placeholder="Tìm kiếm sản phẩm...">
    <select name="supplier">
      <option value="">-- Nhà cung cấp --</option>
      <% suppliers.forEach(s => { %>
        <option value="<%= s._id %>" <%= selectedSupplier == s._id ? 'selected' : '' %>><%= s.name %></option>
      <% }) %>
    </select>
    <button type="submit"><b>Lọc</b></button>
  </form>
  <a href="/products/create" class="btn">Thêm sản phẩm</a>
  <table>
    <thead>
      <tr>
        <th>Tên</th><th>Giá</th><th>Số lượng</th><th>Nhà cung cấp</th><th>Hành động</th>
      </tr>
    </thead>
    <tbody>
      <% products.forEach(p => { %>
        <tr>
          <td><%= p.name %></td>
          <td><%= p.price %></td>
          <td><%= p.quantity %></td>
          <td><%= p.supplier ? p.supplier.name : '' %></td>
          <td>
            <a href="/products/<%= p._id %>/edit">Sửa</a>
            <form method="POST" action="/products/<%= p._id %>/delete" style="display:inline">
              <button type="submit" onclick="return confirm('Xóa sản phẩm này?')">Xóa</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>
<%- include('../partials/footer') %>